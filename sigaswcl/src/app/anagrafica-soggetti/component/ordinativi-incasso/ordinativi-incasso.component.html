<div class="principal-div">
    <div class="card card-primary center-default">
        <div class="card-header text-white">
            <strong>Elenco</strong>
        </div>
        <div>
            <sigas-alert [message]="'Selezionare un Pagamento per procedere con la conciliazione'" [type]="'INFO'"></sigas-alert>
            <sigas-alert *ngIf = "errorMsg" [message]="eMsg" [type]="'DANGER'"></sigas-alert>
            <div class="card-body container">            
                <sigas-alert [message]="messageSuccess" *ngIf="showSuccess" [type]="'SUCCESS'"></sigas-alert>
      			<sigas-alert [message]="messageError" *ngIf="showMessageError" [type]="'DANGER'"></sigas-alert>
            <!--testata-->
		      <div class="form-group col-lg-12 text-center">
		        <h3 class="title">Gestione Pagamenti</h3>
		      </div>
		       <form #ricOrdinativiIncasso="ngForm" >
                <!--testata-->
                <div class="form-group row col-lg-12">
                    <!--anno 
                    <div class="form-group col-lg-6">
                        <div class="row">
                            <label for="anno" class="col-lg-2 col-form-label">Anno:</label>
                            <sigas-spinner-form [diameter]="30" *ngIf="loaderYear;  else elseAnnoCaricato"></sigas-spinner-form>
                            <ng-template #elseAnnoCaricato>
                                <div class="col-lg-4">
                                    <select class="form-control" id="anno" [(ngModel)]="anno" name="anno" required (change)="changeFilter()"  [disabled]="filterDisabled || validato === 'NUOVI'" >
                                        <option *ngFor="let anno of reportAnno" [value]="anno">{{anno}}</option>
                                    </select>
                                </div>
                            </ng-template>
                        </div>
                    </div>
                    -->
                    
                   
                    <div class="col-lg-5 hight">
                    	<div class="form-group row">
                             <label class="col-lg-5 col-form-label">Azienda:</label>
                             <div class="col-lg-6 col-value">
                                 <div class="input-group">
                                 <input type="text" class="form-control col-lg-12 col-form-label" id="azienda"
						                placeholder="Descrizione Azienda" [(ngModel)]="ordinativiService.ricercaOrdinativiReq.azienda" name="azienda"
						                #azienda="ngModel" required pattern=".*\S+.*">   
						                 <div *ngIf="azienda.invalid && (azienda.dirty || azienda.touched)" class="alert alert-danger">
						                    <div >
						                        La descrizione azienda Ã¨ richiesta.
						                    </div>
						                </div> 
                                 </div>
                             </div>
                         </div>
                         <div class="form-group row">
                             <label class="col-lg-5 col-form-label">Codice Azienda:</label>
                             <div class="col-lg-6 col-value">
                                 <div class="input-group">
                                 <input type="text" class="form-control col-lg-12 col-form-label" id="codiceAzienda"
						                placeholder="Codice Azienda" [(ngModel)]="ordinativiService.ricercaOrdinativiReq.codiceAzienda" name="codiceAzienda">   
						                 
                                 </div>
                             </div>
                         </div>
                    	<div class="form-group row">
                                                <label class="col-lg-5 col-form-label">Data Incasso da:</label>
                                                <div class="col-lg-6 col-value">
                                                    <div class="input-group">
                                                    <!-- 
                                                        <input type="date" class="form-control col-lg-11" id="validDal"
                                                            [(ngModel)]="aliquotaToSave.validitaStart" name="validDal"
                                                            (change)="aliquotaToSave.validitaEnd = aliquotaToSave.validitaStart"
                                                            #validDal="ngModel" required> 
                                                             -->
                                                          <input #incassoDa="ngbDatepicker"
				                                               (click)="incassoDa.toggle()"	
				                                               (ngModelChange)="changeFilterDataIncassoDA($event)" 
				                                               [(ngModel)]="dataIncassoDa"
				                                               [footerTemplate]="footerTemplateDa"
				                                               class="form-control col-mg-8 col-lg-8"
				                                               class="form-control"
				                                               name="incassoDa"
				                                               id="incassoDa"
				                                               ngbDatepicker
				                                               placeholder="gg/mm/aaaa"
				                                               readonly>
				                                        <ng-template #footerTemplateDa>
				                                            <hr class="my-0">
				                                            <button (click)="resetDataIncassoDa(); incassoDa.close();"
				                                                    class="btn btn-primary btn-sm m-2 float-left">Pulisci
				                                            </button>
				                                            <button (click)="incassoDa.close()"
				                                                    class="btn btn-secondary btn-sm m-2 float-right">Chiudi
				                                            </button>
				                                        </ng-template>
				                                        <div class="input-group-append">
				                                            <button (click)="incassoDa.toggle()" class="btn btn-outline-secondary calendar"
				                                                    type="button">
				                                                <svg _ngcontent-c4="" class="svg-inline--fa fa-calendar-alt fa-w-14" aria-hidden="true" focusable="false" data-prefix="far" data-icon="calendar-alt" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" data-fa-i2svg=""><path fill="currentColor" d="M148 288h-40c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12zm108-12v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm-96 96v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm-96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm192 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm96-260v352c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h48V12c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v52h128V12c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v52h48c26.5 0 48 21.5 48 48zm-48 346V160H48v298c0 3.3 2.7 6 6 6h340c3.3 0 6-2.7 6-6z"></path></svg>
				                                                <!--<i class="far fa-calendar-alt"></i>-->
				                                            </button>
				                                        </div>  
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <label class="col-lg-5 col-form-label">Data Incasso a:</label>
                                                <div class="col-lg-6 col-value">
                                                    <div class="input-group">
                                                    <!-- 
                                                        <input type="date" class="form-control col-lg-11" id="validAl"
                                                            [(ngModel)]="aliquotaToSave.validitaEnd" name="validAl"
                                                            #validAl="ngModel"
                                                            min="{{ aliquotaToSave.validitaStart | date:'yyyy-MM-dd'}}"
                                                            required>
                                                           -->  
                                                        <input #incassoA="ngbDatepicker"
			                                               (click)="incassoA.toggle()"
			                                               (ngModelChange)="changeFilterDataIncassoA($event)" 
			                                               [(ngModel)]="dataIncassoA"
			                                               [footerTemplate]="footerTemplateA"
			                                               class="form-control col-mg-8 col-lg-8"
			                                               class="form-control"
			                                               name="incassoA"
			                                               id="incassoA"
			                                               ngbDatepicker
			                                               placeholder="gg/mm/aaaa"
			                                               readonly>
				                                        <ng-template #footerTemplateA>
				                                            <hr class="my-0">
				                                            <button (click)="resetDataIncassoA(); incassoA.close();"
				                                                    class="btn btn-primary btn-sm m-2 float-left">Pulisci
				                                            </button>
				                                            <button (click)="incassoA.close()"
				                                                    class="btn btn-secondary btn-sm m-2 float-right">Chiudi
				                                            </button>
				                                        </ng-template>
				                                        <div class="input-group-append">
				                                            <button (click)="incassoA.toggle()" class="btn btn-outline-secondary calendar"
				                                                    type="button">
				                                                <svg _ngcontent-c4="" class="svg-inline--fa fa-calendar-alt fa-w-14" aria-hidden="true" focusable="false" data-prefix="far" data-icon="calendar-alt" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" data-fa-i2svg=""><path fill="currentColor" d="M148 288h-40c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12zm108-12v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm-96 96v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm-96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm192 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm96-260v352c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h48V12c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v52h128V12c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v52h48c26.5 0 48 21.5 48 48zm-48 346V160H48v298c0 3.3 2.7 6 6 6h340c3.3 0 6-2.7 6-6z"></path></svg>
				                                                <!--<i class="far fa-calendar-alt"></i>-->
				                                            </button>
				                                        </div>
                                                    </div>
                                                </div>
                                                </div>
                </div>
                
                 <div class="col-lg-5 hight">
                    	<div class="form-group row">
                            <label for="anno" class="col-lg-5 col-form-label">Stato conciliazione:</label>
                                <div class="col-lg-6" col-values>
                                    <select class="form-control" id="statoConciliazione" [(ngModel)]="statoConciliazione"  name="statoConciliazione" required (change)="changeFilter()"  >
                                        <option value="all" selected></option> 
                                        <option value="Conciliato" selected>Conciliato</option> 
                                        <option value="Da_Conciliare" selected>Da Conciliare</option>
                                        <option value="Conciliato_Parziale" selected>Conciliato Parziale</option> 
                                    </select>
                                </div>
                           
                    </div>
                </div>
                </div>
                
                <div class="bs-example" data-example-id="single-button-dropdown">
                    <div class="form-group row col-lg-12">
                        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 text-center">

                            
                            <div class="btn-group">
                                <button type="button" class="btn btn-primary margin-icon" (click)="ricercaOrdinativi()"
                                		[disabled]="!ricOrdinativiIncasso.form.valid ">
                                    <i class="fas fa-check"></i> Ricerca </button>
                            </div>
							

                        </div>
                    </div>
                </div>
                </form>
                <div class="form-group row">
                    <div class="col-lg-12">
                        <div class="form-group col-lg-12">
                            <div class="form-group col-lg-12">
                                <sigas-spinner-form [diameter]="30" *ngIf="loaderDT"></sigas-spinner-form>
                                <div class="view">
  <div class="wrapper">
                                <table [style.display]="!loaderDT ? '' : 'none' " id="elencoOrdinativiIncasso"  class="row-border hover" 
                                    datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger"  width="2500px" >
                                    <thead>
                                        <tr>
                                            <th class="sticky-col first-col"></th> 
                                            <th class="sticky-col second-col"></th>
                                            <th [ngStyle]="{'display':  'none'}" class="sticky-col third-col">Importo Attuale</th>
                                            <th class="sticky-col third-col"> Importo Attuale</th>
                                   <!--  <th>Descrizione Soggetto</th>   -->        
                                   			<th [ngStyle]="{'display':  'none'}" >Data Emissione</th> 
                                   			<th>Data Emissione</th> 
                                            <th>Desc. Ord. Inc.</th>
                                            
                                            
                                            
                                            <th> Anno Atto Amm. </th> 
									        <th> Anno Ord Inc. </th> 
									        <th> Cf. Soggetto </th> 
									        <th> Cod. Capitolo </th> 
									        <th> Cod. Soggetto </th>
								
											<th [ngStyle]="{'display':  'none'}" >Data Elaborazione</th> 
									        <th> Data Elaborazione </th> 
									        <th [ngStyle]="{'display':  'none'}" >Data Firma</th>
									        <th> Data Firma </th> 
									        <th> Desc. Capitolo </th> 
									        <th> Desc. Distinta </th> 
									        <th> Desc. Pdc. Finanziario Iv </th> 
									        <th> Desc. Pdc. Finanziario V </th>
									        <th> Desc. Soggetto </th> 
									        <th> Desc. Stato Ord. Inc.</th> 
									        <th> Desc. Tipo Atto Amm.</th> 
									        <th> Firma </th> 
									        <th [ngStyle]="{'display':  'none'}" >Importo Iniziale</th> 
									        <th> Importo Iniziale </th> 
									        <th> Note Atto Amm.</th> 
									        <th> Num. Atto Amm.</th> 
									        <th> Num. Ord. Inc. </th> 
									        <th> Oggetto Atto Amm.</th> 
									        <th> P. Iva Soggetto </th> 
									        <th> Soggetto Id</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr class ="pointer" *ngFor="let el of elencoOrdinativiIncasso; let i = index " (click) = "dettaglioOrdinativoIncasso(el)">
                                            <td class="sticky-col first-col"> 
                                           <!--       <input type="radio"  name="selection" ngModel (click)="ordinativoSelect($event,el)" > -->
                                                <input type="radio"  name="selection" (click)="ordinativoSelect(el)">
                                            </td> 
                                            <td class="sticky-col second-col"><div *ngIf="el.sigasPagamentiVersamentis.length>0"><button type="button" class="btn btn-link  btn-sm" (click)="eliminaConciliazione(el)"
                                 			  data-toggle="modal" data-target="#dialogConferma">
                                    <i class="fas fa-trash-alt"></i> </button></div></td>
                                            <td class="sticky-col third-col">{{ el.importoAttuale  | currency:'EUR':'symbol'  }}</td>
                                            <td class="sticky-col four-col"  [ngStyle]="{'display':  'none'}"	><div  >{{ el.importoAttuale  }}</div></td>
                                 			      
                                  			<td>{{ el.dataEmissione | date : 'dd/MM/yyyy'}}</td>     
                                  			<td   [ngStyle]="{'display':  'none'}">{{ el.dataEmissione}}</td>   
                                            <td>{{ el.descOrdInc }}</td>
                                            
                                            
                                            
									        <td> {{ el.annoAttoAmministrativo }}</td> 
									        <td> {{ el.annoOrdInc }}</td> 
									        <td> {{ el.cfSoggetto }}</td> 
									        <td> {{ el.codCapitolo }}</td> 
									        <td> {{ el.codSoggetto }}</td>
									        <td> {{ el.dataElaborazione | date : 'dd/MM/yyyy' }}</td> 
									        <td   [ngStyle]="{'display':  'none'}">{{ el.dataElaborazione}}</td>   
									        <td> {{ el.dataFirma | date : 'dd/MM/yyyy' }}</td> 
									        <td   [ngStyle]="{'display':  'none'}">{{ el.dataFirma}}</td>   
									        <td> {{ el.descCapitolo }}</td> 
									        <td> {{ el.descDistinta }}</td> 
									        <td> {{ el.descPdcFinanziarioIv }}</td> 
									        <td> {{ el.descPdcFinanziarioV }}</td>
									        <td> {{ el.descSoggetto }}</td> 
									        <td> {{ el.descStatoOrdInc }}</td> 
									        <td> {{ el.descTipoAttoAmministrativo }}</td> 
									        <td> {{ el.firma }}</td> 
									        <td> {{ el.importoIniziale | currency:'EUR':'symbol' }}</td> 
									        <td   [ngStyle]="{'display':  'none'}">{{ el.importoIniziale}}</td>   
									        <td> {{ el.noteAttoAmministrativo }}</td> 
									        <td> {{ el.numAttoAmministrativo }}</td> 
									        <td> {{ el.numOrdInc }}</td>
									        <td> {{ el.oggettoAttoAmministrativo }}</td> 
									        <td> {{ el.pIvaSoggetto }}</td> 
									        <td> {{ el.soggettoId }}</td>
                                        </tr>
                                    </tbody>
                                </table>
                                </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!--tabella-->
                <!--pulsanti-->
                <div class="bs-example" data-example-id="single-button-dropdown">

                        <div class="form-group row col-lg-12">
                                      <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 text-center">

                            <div class="btn-group">                               
			                                    <button class="btn btn-default margin-icon btn-standard" (click)="goBack()" role="button" >
			                    					<i class="fa fa-angle-left"></i> indietro</button>
			                            </div>  
                            
                            <div class="btn-group">
                                <button type="button" class="btn btn-primary margin-icon" (click)="goAssociazioneSoggetto()"
                                [disabled]="!ordinativiService.listaOrdinativiIncassoSelezionati"
                                		>
                                    <i class="fas fa-check"></i> Seleziona Soggetto e concilia pagamento</button>
                            </div>
							<!-- 
                            <div class="btn-group">
                                <button type="button" *ngIf="!loaderExcel" [disabled]="(anno == null || anno == '') && validato != 'NUOVI' " class="btn btn-success margin-icon pointer" (click)="goExcel()">
                                    <i class="far fa-file-excel"></i> Scarica in Excel</button>
                                <button type="button" *ngIf="loaderExcel" class="btn btn-success">
                                    <sigas-spinner-form [diameter]="20"></sigas-spinner-form>
                                </button>
                            </div>
 							-->
                            <!-- <div class="btn-group">
                                <button type="button" (click)="cancella()" class="btn btn-primary">
                                    <i class="fa fa-angle-left glyphicon glyphicon-remove"></i> Cancella</button>
                            </div>

                            <div class="btn-group">
                                <button type="submit" class="btn btn-primary margin-icon" [disabled]="!hasSelected()">
                                    <i class="fa fa-angle-left glyphicon glyphicon-ok"></i> Conferma</button>
                            </div> -->

                        </div>
                    </div>
                <!--pulsanti-->
    </div>
    
    <div class="modal fade" id="dialogConferma" role="dialog">
	    <div class="modal-dialog">
	        <div class="modal-content">
	        
	             <div class="modal-header">
	               <h4 class="modal-title">Attenzione</h4>
	              <button type="button" class="close" data-dismiss="modal">&times;</button>
	            </div>
	        
	            <div class="modal-body">
	             <p>
		                    <span *ngIf="messageDialog!=null">{{messageDialog}}</span>
		                </p>
	                <div class="principal-div">
	               <div class="contains">
		               <div class="form-group row" *ngIf="!loaderDT">
				          <div class="col-lg-12">
					    <div class="form-group col-lg-12 text-center" *ngIf="soggetto!=null">
					      <h5 class="title">{{soggetto}}</h5>
					    </div>
				              <div class="form-group col-lg-12">
				                  <div class="form-group col-lg-12">
				                      <table width="100%">
				                          <thead>
				                              <tr>
				                                  <th>Anno</th>
				                                  <th>Mese</th>
				                                  <th>Provincia</th>
				                                  <th>Tipo</th>
				                                  <th>importo </th>
				                              </tr>
				                          </thead>
				                          <tbody>
				                              <tr class ="pointer" *ngFor="let el of ordinativoDaCancellare.sigasPagamentiVersamentis" >				                                 
				                                   <td>{{ el.fkVersamento.annualita }}</td>
				                                  <td>{{ el.fkVersamento.mese }}</td>
				                                  <td>{{ el.fkVersamento.provincia }}</td>
				                                  <td>{{ el.fkVersamento.tipo.denominazione }}</td>
				                                  <td>{{ el.fkVersamento.importo | currency:'EUR':'symbol' }}</td>
				                              </tr>
				                          </tbody>
				                      </table>
				                  </div>
				              </div>
				          </div>
				      </div>
			      </div>
		      </div>
	            </div>
	            <div class="modal-footer">
	               <button type="button" class="btn btn-default" data-dismiss="modal">{{buttonAnnullaText}}</button>
	               <button type="button" class="btn btn-primary" (click)="confermaEliminaConciliazione(ordinativoDaCancellare)">{{buttonConfirmText}}</button>
	            </div>
	        </div>
	
	    </div>
	</div>
</div>